language: c++
# command to install dependencies
before_install:
  - sudo apt-get install -y gdb # to capture backtrace of eventual failures
  - sudo add-apt-repository -y ppa:octave/stable
  - sudo apt-get update -qq
  - sudo apt-get install octave
  #- sudo apt-get purge libopenblas-base

before_script:
- ulimit -c unlimited -S       # enable core dumps

script:
  - cd test && /usr/bin/octave -q --eval 'plot([0 1 1.5 1 -1])'
notifications:
  hipchat: f4c2c5f87adc85025545e5b59b3fbe@Matlab2tikz

after_failure:
- COREFILE=$(find . -maxdepth 1 -name "core*" | head -n 1) # find core file
- if [[ -f "$COREFILE" ]]; then gdb --args /usr/bin/octave-cli --persist --eval "plot([0 1 1.5 1 -1])"; fi
